# å¾®ä¿¡èŠå¤©è®°å½•å¤„ç†å·¥å…· v2.0

[![Python Version](https://img.shields.io/badge/python-3.8%2B-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-2.0-brightgreen.svg)](CHANGELOG.md)

ä¸€ä¸ªå¼ºå¤§çš„å¾®ä¿¡èŠå¤©è®°å½•å¤„ç†å·¥å…·ï¼Œç”¨äºå°†å¾®ä¿¡èŠå¤©æ•°æ®è½¬æ¢ä¸ºé«˜è´¨é‡çš„AIè®­ç»ƒæ•°æ®é›†ã€‚è¯¥å·¥å…·é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒæ™ºèƒ½å†å²è®°å½•æ„å»ºã€è”ç³»äººå…³ç³»ç®¡ç†å’Œå¤§æ¨¡å‹è´¨é‡è¯„ä¼°ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ æ™ºèƒ½å†å²è®°å½•æ„å»º
- **72å°æ—¶æ—¶é—´çª—å£**ï¼šæ‰©å±•å†å²è®°å½•èŒƒå›´ï¼Œæä¾›æ›´ä¸°å¯Œçš„å¯¹è¯ä¸Šä¸‹æ–‡
- **æ™ºèƒ½è”ç³»äººè¿‡æ»¤**ï¼šåªæ˜¾ç¤ºä¸å½“å‰å¯¹è¯è€…ç›¸å…³çš„å†å²æ¶ˆæ¯
- **æ—¥æœŸæ—¶é—´ä¼˜åŒ–**ï¼šå®Œæ•´çš„æ—¥æœŸæ˜¾ç¤ºå’Œæ™ºèƒ½æ—¥æœŸåˆ†éš”çº¿
- **ä¸Šä¸‹æ–‡è¿è´¯æ€§**ï¼šä¿æŒå¯¹è¯é€»è¾‘æ€§å’Œæ—¶é—´è¿ç»­æ€§

### ğŸ‘¥ è”ç³»äººå…³ç³»ç®¡ç†  
- **è‡ªåŠ¨ä¿¡æ¯æå–**ï¼šä»users.jsonè‡ªåŠ¨åŠ è½½è”ç³»äººåŸºæœ¬ä¿¡æ¯
- **å…³ç³»åˆ†ç±»ç®¡ç†**ï¼šæ”¯æŒæœ‹å‹ã€åŒäº‹ã€å®¶äººç­‰å¤šç§å…³ç³»ç±»å‹
- **äº¤äº’å¼ç¼–è¾‘**ï¼šå‹å¥½çš„å‘½ä»¤è¡Œç•Œé¢ç®¡ç†è”ç³»äººå…³ç³»
- **ç»Ÿè®¡åˆ†æ**ï¼šæä¾›è¯¦ç»†çš„è”ç³»äººæ´»è·ƒåº¦ç»Ÿè®¡

### ğŸ¤– å¤§æ¨¡å‹è´¨é‡è¯„ä¼°
- **æ™ºèƒ½è¯„åˆ†**ï¼šä½¿ç”¨å¤§æ¨¡å‹å¯¹è®­ç»ƒæ ·æœ¬è¿›è¡Œè´¨é‡è¯„ä¼°
- **ç¼“å­˜æœºåˆ¶**ï¼šé¿å…é‡å¤è¯„ä¼°ï¼Œæé«˜å¤„ç†æ•ˆç‡
- **çµæ´»ç­›é€‰**ï¼šæ”¯æŒå¤šç§åˆ†æ•°é˜ˆå€¼çš„æ•°æ®ç­›é€‰
- **è¯„ä¼°æŠ¥å‘Š**ï¼šç”Ÿæˆè¯¦ç»†çš„è´¨é‡è¯„ä¼°æŠ¥å‘Š

### ğŸ”§ æ¨¡å—åŒ–æ¶æ„
- **æ¸…æ™°åˆ†å±‚**ï¼šæ ¸å¿ƒå¤„ç†ã€ç®¡ç†å™¨ã€å·¥å…·å’Œè¯„ä¼°å™¨åˆ†ç¦»
- **æ˜“äºæ‰©å±•**ï¼šæ¨¡å—åŒ–è®¾è®¡ä¾¿äºåŠŸèƒ½æ‰©å±•å’Œç»´æŠ¤
- **é«˜æ€§èƒ½**ï¼šæ”¯æŒå¤šè¿›ç¨‹å¤„ç†å¤§é‡æ•°æ®
- **å®¹é”™æ€§å¼º**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œå¼‚å¸¸æ¢å¤

## ğŸ“ é¡¹ç›®ç»“æ„

```
wechat_message_processor/
â”œâ”€â”€ main.py                     # ğŸš€ ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ README.md                   # ğŸ“– é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ config.json                 # âš™ï¸ é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt            # ğŸ“¦ ä¾èµ–åˆ—è¡¨
â”‚
â”œâ”€â”€ core/                       # ğŸ”§ æ ¸å¿ƒå¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_processor.py       # æ•°æ®å¤„ç†å™¨
â”‚   â””â”€â”€ main_processor.py       # ä¸»è¦å¤„ç†æµç¨‹
â”‚
â”œâ”€â”€ managers/                   # ğŸ“‹ ç®¡ç†å™¨æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config_manager.py       # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ contact_manager.py      # è”ç³»äººç®¡ç†
â”‚   â””â”€â”€ evaluation_cache.py     # è¯„ä¼°ç¼“å­˜ç®¡ç†
â”‚
â”œâ”€â”€ utils/                      # ğŸ› ï¸ å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ history_utils.py        # å†å²è®°å½•å¤„ç†å·¥å…·
â”‚
â”œâ”€â”€ evaluators/                 # ğŸ¤– è¯„ä¼°æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ llm_evaluator.py        # å¤§æ¨¡å‹è¯„ä¼°å™¨
â”‚
â”œâ”€â”€ data/                       # ğŸ“ æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ contact1/
â”‚   â”‚   â”œâ”€â”€ messages.csv
â”‚   â”‚   â””â”€â”€ users.json
â”‚   â””â”€â”€ contact2/
â”‚       â”œâ”€â”€ messages.csv
â”‚       â””â”€â”€ users.json
â”‚
â””â”€â”€ output/                     # ğŸ“¤ è¾“å‡ºç›®å½•
    â”œâ”€â”€ stage1_results.json     # é˜¶æ®µ1ç»“æœ
    â”œâ”€â”€ training_data.json      # æœ€ç»ˆè®­ç»ƒæ•°æ®
    â”œâ”€â”€ contacts.json           # è”ç³»äººæ•°æ®åº“
    â””â”€â”€ evaluation_cache.json   # è¯„ä¼°ç¼“å­˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

1. **Pythonç¯å¢ƒè¦æ±‚**
   ```bash
   # Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
   python --version
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

3. **æ•°æ®å‡†å¤‡**
   
   å°†å¾®ä¿¡èŠå¤©è®°å½•CSVæ–‡ä»¶æ”¾ç½®åœ¨ä»¥ä¸‹ç»“æ„ä¸­ï¼š
   ```
   data/
   â”œâ”€â”€ è”ç³»äºº1/
   â”‚   â”œâ”€â”€ messages.csv    # èŠå¤©è®°å½•
   â”‚   â””â”€â”€ users.json      # è”ç³»äººä¿¡æ¯
   â”œâ”€â”€ è”ç³»äºº2/
   â”‚   â”œâ”€â”€ messages.csv
   â”‚   â””â”€â”€ users.json
   â””â”€â”€ ...
   ```

4. **é…ç½®æ–‡ä»¶**
   
   å¤åˆ¶å¹¶ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š
   ```bash
   cp config.example.json config.json
   # ç¼–è¾‘ config.jsonï¼Œè®¾ç½®ä½ çš„å‚æ•°
   ```

### åŸºæœ¬ä½¿ç”¨

#### ğŸ¯ æ¨èå·¥ä½œæµï¼ˆåˆ†é˜¶æ®µå¤„ç†ï¼‰

```bash
# 1. é˜¶æ®µ1: æ•°æ®æå–å’Œè”ç³»äººä¿¡æ¯å»ºç«‹
python main.py stage1

# 2. ç®¡ç†è”ç³»äººå…³ç³»ï¼ˆå¯é€‰ï¼‰
python main.py contacts

# 3. é˜¶æ®µ2: å¤§æ¨¡å‹è¯„ä¼°å’Œæœ€ç»ˆæ•°æ®é›†ç”Ÿæˆ
python main.py stage2

# 4. ä»ç¼“å­˜ç­›é€‰ä¸åŒåˆ†æ•°çš„æ•°æ®ï¼ˆå¯é€‰ï¼‰
python main.py filter
```

#### ğŸ”„ å®Œæ•´å¤„ç†æµç¨‹ï¼ˆå…¼å®¹æ¨¡å¼ï¼‰

```bash
# ä¸€æ¬¡æ€§å®Œæˆæ‰€æœ‰å¤„ç†æ­¥éª¤
python main.py
```

#### ğŸ“‹ æŸ¥çœ‹å¸®åŠ©

```bash
python main.py help
```

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºæœ¬é…ç½® (config.json)

```json
{
  "data_processing": {
    "data_dir": "data",                    // æ•°æ®ç›®å½•è·¯å¾„
    "output_file": "training_data.json",   // è¾“å‡ºæ–‡ä»¶å
    "my_wxid": "your_wechat_id",          // ä½ çš„å¾®ä¿¡ID
    "max_inter_message_gap": 90,          // æ¶ˆæ¯å—å†…æœ€å¤§é—´éš”ï¼ˆç§’ï¼‰
    "max_reply_delay": 300,               // æœ€å¤§å›å¤å»¶è¿Ÿï¼ˆç§’ï¼‰
    "use_multiprocessing": true,          // æ˜¯å¦ä½¿ç”¨å¤šè¿›ç¨‹
    "max_workers": 4                      // æœ€å¤§è¿›ç¨‹æ•°
  },
  "llm_evaluation": {
    "enabled": true,                      // æ˜¯å¦å¯ç”¨å¤§æ¨¡å‹è¯„ä¼°
    "api_url": "https://api.example.com/v1/chat/completions",
    "api_key": "your_api_key",
    "model": "your_model_name",
    "max_workers": 3,                     // è¯„ä¼°å¹¶å‘æ•°
    "min_score": 5.0,                     // æœ€ä½é€šè¿‡åˆ†æ•°
    "timeout": 30,                        // è¯·æ±‚è¶…æ—¶æ—¶é—´
    "retry_attempts": 3,                  // é‡è¯•æ¬¡æ•°
    "evaluation_prompt": "è¯·è¯„ä¼°è¿™ä¸ªè®­ç»ƒæ ·æœ¬çš„è´¨é‡..."
  }
}
```

### é«˜çº§é…ç½®é€‰é¡¹

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `max_inter_message_gap` | 90 | åŒä¸€æ¶ˆæ¯å—å†…æ¶ˆæ¯é—´æœ€å¤§æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰ |
| `max_reply_delay` | 300 | è®¤å®šä¸ºæœ‰æ•ˆå›å¤çš„æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼ˆç§’ï¼‰ |
| `use_multiprocessing` | true | å¤§æ•°æ®é›†æ—¶æ˜¯å¦å¯ç”¨å¤šè¿›ç¨‹åŠ é€Ÿ |
| `max_workers` | 4 | å¤šè¿›ç¨‹å¤„ç†æ—¶çš„æœ€å¤§è¿›ç¨‹æ•° |
| `min_score` | 5.0 | å¤§æ¨¡å‹è¯„ä¼°çš„æœ€ä½é€šè¿‡åˆ†æ•°ï¼ˆ1-10åˆ†ï¼‰ |

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### ğŸ”„ å†å²è®°å½•æ„å»º

#### ä¼ ç»Ÿæ–¹æ¡ˆ vs æ–°æ–¹æ¡ˆå¯¹æ¯”

**ä¼ ç»Ÿæ–¹æ¡ˆé—®é¢˜ï¼š**
```python
# æ—§ç‰ˆæœ¬åªè·å–å½“æ—¥æ¶ˆæ¯ï¼Œä¸”æ··åˆæ‰€æœ‰è”ç³»äºº
def build_context_old(messages, reply_time):
    reply_date = reply_time.date()
    context_messages = []
    for msg in messages:
        if msg['create_time'].date() == reply_date:
            context_messages.append(msg)  # åŒ…å«æ‰€æœ‰äººçš„æ¶ˆæ¯
    return context_messages
```

**æ–°æ–¹æ¡ˆæ”¹è¿›ï¼š**
```python
# æ–°ç‰ˆæœ¬ï¼š72å°æ—¶çª—å£ + æ™ºèƒ½è”ç³»äººè¿‡æ»¤
def build_context_new(messages, reply_time, current_talker_id):
    time_72h_ago = reply_time - timedelta(hours=72)
    context_messages = []
    for msg in messages:
        if time_72h_ago <= msg['create_time'] < reply_time:
            # åªåŒ…å«ç›¸å…³å¯¹è¯ï¼šå¯¹æ–¹å‘çš„æ¶ˆæ¯ + æˆ‘çš„æ‰€æœ‰æ¶ˆæ¯
            if (msg['is_sender'] == 0 and msg['talker'] == current_talker_id) or \
               (msg['is_sender'] == 1):
                context_messages.append(msg)
    return context_messages
```

#### å†å²è®°å½•å±•ç¤ºæ•ˆæœ

**æ–°ç‰ˆæœ¬æ˜¾ç¤ºæ•ˆæœï¼š**
```
â€”â€”â€”â€”â€” 2024å¹´03æœˆ15æ—¥ â€”â€”â€”â€”â€”
[14:32:15] å°æ˜: ä»Šå¤©çš„ä¼šè®®å‡†å¤‡å¾—æ€ä¹ˆæ ·ï¼Ÿ
[14:35:22] æˆ‘: å·®ä¸å¤šäº†ï¼ŒPPTå·²ç»åšå®Œäº†
[16:20:45] å°æ˜: é‚£å°±å¥½ï¼Œæ˜å¤©è§

â€”â€”â€”â€”â€” 2024å¹´03æœˆ16æ—¥ â€”â€”â€”â€”â€”
[09:15:30] å°æ˜: æ—©ä¸Šå¥½ï¼
[09:16:12] æˆ‘: æ—©ä¸Šå¥½ï¼Œå‡†å¤‡å‡ºå‘äº†å—ï¼Ÿ
[18:45:23] å°æ˜: ä»Šå¤©å¼€ä¼šçš„äº‹æƒ…æˆ‘æƒ³å†è®¨è®ºä¸€ä¸‹
```

### ğŸ‘¥ è”ç³»äººå…³ç³»ç®¡ç†

#### æ”¯æŒçš„å…³ç³»ç±»å‹
- ğŸ‘« **æœ‹å‹** - ä¸€èˆ¬æœ‹å‹å…³ç³»
- ğŸ’¼ **åŒäº‹** - å·¥ä½œç›¸å…³è”ç³»äºº  
- ğŸ“ **åŒå­¦** - å­¦æ ¡å…³ç³»
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ **å®¶äºº** - å®¶åº­æˆå‘˜
- ğŸ’• **æ‹äºº** - æ‹çˆ±å…³ç³»
- ğŸ‘¨â€ğŸ« **å¸ˆé•¿** - è€å¸ˆã€å¯¼å¸ˆç­‰
- ğŸ‘¨â€ğŸ“ **å­¦ç”Ÿ** - å­¦ç”Ÿå…³ç³»
- ğŸ¤ **å®¢æˆ·** - å•†åŠ¡å…³ç³»
- â“ **é™Œç”Ÿäºº** - ä¸ç†Ÿæ‚‰çš„äºº
- ğŸ“‹ **å…¶ä»–** - è‡ªå®šä¹‰å…³ç³»

#### è”ç³»äººç®¡ç†æ“ä½œ

```bash
# è¿›å…¥è”ç³»äººç®¡ç†ç•Œé¢
python main.py contacts

# æ”¯æŒçš„æ“ä½œï¼š
# 1. æŸ¥çœ‹æ‰€æœ‰è”ç³»äºº - æ˜¾ç¤ºè”ç³»äººåˆ—è¡¨å’Œç»Ÿè®¡ä¿¡æ¯
# 2. æœç´¢è”ç³»äºº - é€šè¿‡æ˜µç§°/å¤‡æ³¨/IDæœç´¢
# 3. æ›´æ–°è”ç³»äººå…³ç³» - ä¿®æ”¹å…³ç³»ç±»å‹å’Œè¯¦ç»†å¤‡æ³¨
# 4. å¯¼å‡ºè”ç³»äººåˆ—è¡¨ - ç”Ÿæˆå®Œæ•´çš„è”ç³»äººæŠ¥å‘Š
```

### ğŸ¤– å¤§æ¨¡å‹è´¨é‡è¯„ä¼°

#### è¯„ä¼°æ ‡å‡†
- **å¯¹è¯è‡ªç„¶æ€§** (25%) - å›å¤æ˜¯å¦è‡ªç„¶æµç•…
- **å†…å®¹ç›¸å…³æ€§** (25%) - å›å¤æ˜¯å¦ä¸ä¸Šä¸‹æ–‡ç›¸å…³
- **è¯­è¨€é£æ ¼** (25%) - æ˜¯å¦ä¿æŒä¸€è‡´çš„è¯­è¨€é£æ ¼
- **ä¿¡æ¯å®Œæ•´æ€§** (25%) - æ˜¯å¦åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯

#### è¯„ä¼°æµç¨‹
1. **æ™ºèƒ½ç¼“å­˜** - é¿å…é‡å¤è¯„ä¼°ç›¸åŒæ ·æœ¬
2. **å¹¶å‘å¤„ç†** - æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘è¯„ä¼°
3. **é”™è¯¯é‡è¯•** - ç½‘ç»œé”™è¯¯æ—¶è‡ªåŠ¨é‡è¯•
4. **åˆ†æ•°è§£æ** - æ™ºèƒ½æå–è¯„åˆ†ç»“æœ
5. **ç»“æœç­›é€‰** - æ ¹æ®åˆ†æ•°é˜ˆå€¼ç­›é€‰é«˜è´¨é‡æ•°æ®

#### è¯„ä¼°ç»“æœåˆ†æ
```json
{
  "total_samples": 1000,
  "evaluated_samples": 1000,
  "passed_samples": 750,
  "average_score": 6.8,
  "score_distribution": {
    "0-2": 50,
    "2-4": 100,
    "4-6": 100,
    "6-8": 500,
    "8-10": 250
  }
}
```

## ğŸ“Š è¾“å‡ºæ–‡ä»¶è¯´æ˜

### é˜¶æ®µ1è¾“å‡ºæ–‡ä»¶

| æ–‡ä»¶å | æè¿° | å†…å®¹ |
|--------|------|------|
| `stage1_results.json` | å®Œæ•´çš„é˜¶æ®µ1ç»“æœ | è®­ç»ƒæ•°æ®ã€è¯­è¨€æ¨¡å¼ã€åŸå§‹æ¶ˆæ¯ã€å¯¹è¯å›åˆ |
| `stage1_training_data.json` | çº¯è®­ç»ƒæ•°æ® | ä»…åŒ…å«instructionã€inputã€outputæ ¼å¼çš„è®­ç»ƒæ ·æœ¬ |
| `contacts.json` | è”ç³»äººæ•°æ®åº“ | æ‰€æœ‰è”ç³»äººçš„è¯¦ç»†ä¿¡æ¯å’Œå…³ç³»æ•°æ® |

### é˜¶æ®µ2è¾“å‡ºæ–‡ä»¶

| æ–‡ä»¶å | æè¿° | å†…å®¹ |
|--------|------|------|
| `training_data.json` | æœ€ç»ˆå®Œæ•´ç»“æœ | ç»è¿‡è¯„ä¼°çš„å®Œæ•´è®­ç»ƒæ•°æ®å’Œåˆ†ææŠ¥å‘Š |
| `training_data_training_only.json` | æœ€ç»ˆçº¯è®­ç»ƒæ•°æ® | ä»…åŒ…å«é«˜è´¨é‡çš„è®­ç»ƒæ ·æœ¬ |
| `evaluation_cache.json` | è¯„ä¼°ç¼“å­˜ | æ‰€æœ‰æ ·æœ¬çš„è¯„ä¼°ç»“æœç¼“å­˜ |
| `evaluation_report.json` | è¯„ä¼°æŠ¥å‘Š | è¯¦ç»†çš„è´¨é‡è¯„ä¼°ç»Ÿè®¡å’Œåˆ†æ |

### ç¼“å­˜ç­›é€‰è¾“å‡º

| æ–‡ä»¶å | æè¿° |
|--------|------|
| `training_data_filtered_{score}.json` | æŒ‰åˆ†æ•°ç­›é€‰çš„å®Œæ•´ç»“æœ |
| `training_only_filtered_{score}.json` | æŒ‰åˆ†æ•°ç­›é€‰çš„çº¯è®­ç»ƒæ•°æ® |

## ğŸ”§ é«˜çº§ç”¨æ³•

### æ‰¹é‡å¤„ç†å¤šä¸ªæ•°æ®é›†

```bash
# å¤„ç†ä¸åŒæ•°æ®é›†
python main.py stage1 --data-dir dataset1
python main.py stage1 --data-dir dataset2

# åˆå¹¶ç»“æœ
python tools/merge_datasets.py dataset1/output dataset2/output
```

### è‡ªå®šä¹‰è¯„ä¼°æ ‡å‡†

```python
# åœ¨ evaluators/llm_evaluator.py ä¸­ä¿®æ”¹è¯„ä¼°æç¤º
evaluation_prompt = """
è‡ªå®šä¹‰è¯„ä¼°æ ‡å‡†ï¼š
1. ä¸“ä¸šæœ¯è¯­ä½¿ç”¨å‡†ç¡®æ€§ (30%)
2. æƒ…æ„Ÿè¡¨è¾¾æ°å½“æ€§ (30%)  
3. å¯¹è¯é€»è¾‘è¿è´¯æ€§ (25%)
4. æ–‡åŒ–èƒŒæ™¯é€‚åº”æ€§ (15%)

è¯·å¯¹ä»¥ä¸‹æ ·æœ¬è¯„åˆ†(1-10åˆ†)ï¼š
æŒ‡ä»¤: {instruction}
è¾“å…¥: {input}
è¾“å‡º: {output}
"""
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### å¤§æ•°æ®é›†å¤„ç†ä¼˜åŒ–

```json
{
  "data_processing": {
    "use_multiprocessing": true,
    "max_workers": 8,              // æ ¹æ®CPUæ ¸å¿ƒæ•°è°ƒæ•´
    "chunk_size": 5000             // å¢å¤§å—å¤§å°
  },
  "llm_evaluation": {
    "max_workers": 5,              // æ ¹æ®APIé™åˆ¶è°ƒæ•´
    "batch_size": 20,              // æ‰¹é‡è¯„ä¼°
    "timeout": 60                  // å¢åŠ è¶…æ—¶æ—¶é—´
  }
}
```

#### å†…å­˜ä½¿ç”¨ä¼˜åŒ–

```python
# å¯¹äºè¶…å¤§æ•°æ®é›†ï¼Œå¯ç”¨æµå¼å¤„ç†
ENABLE_STREAMING = True
STREAM_CHUNK_SIZE = 1000

# å®šæœŸæ¸…ç†å†…å­˜
import gc
gc.collect()
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜è§£å†³

#### 1. å¯¼å…¥é”™è¯¯
```bash
# é”™è¯¯: ModuleNotFoundError: No module named 'core'
# è§£å†³: ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cd /path/to/wechat_message_processor
python main.py
```

#### 2. æ•°æ®æ ¼å¼é”™è¯¯  
```bash
# é”™è¯¯: CSVæ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®
# è§£å†³: æ£€æŸ¥CSVæ–‡ä»¶æ˜¯å¦åŒ…å«å¿…è¦å­—æ®µ
required_columns = ['id', 'CreateTime', 'is_sender', 'talker', 'msg', 'type_name']
```

#### 3. å¤§æ¨¡å‹APIé”™è¯¯
```bash
# é”™è¯¯: APIè°ƒç”¨å¤±è´¥
# è§£å†³: æ£€æŸ¥APIé…ç½®å’Œç½‘ç»œè¿æ¥
# 1. éªŒè¯APIå¯†é’¥æ˜¯å¦æ­£ç¡®
# 2. æ£€æŸ¥API URLæ˜¯å¦å¯è®¿é—®
# 3. ç¡®è®¤APIè¯·æ±‚æ ¼å¼æ˜¯å¦ç¬¦åˆè¦æ±‚
```

#### 4. å†…å­˜ä¸è¶³
```bash
# é”™è¯¯: MemoryError
# è§£å†³: è°ƒæ•´å¤„ç†å‚æ•°
{
  "data_processing": {
    "use_multiprocessing": false,  // ç¦ç”¨å¤šè¿›ç¨‹
    "max_workers": 2,              // å‡å°‘è¿›ç¨‹æ•°
    "chunk_size": 1000            // å‡å°å—å¤§å°
  }
}
```

### æ—¥å¿—å’Œè°ƒè¯•

#### å¯ç”¨è¯¦ç»†æ—¥å¿—
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

#### æ€§èƒ½ç›‘æ§
```bash
# ç›‘æ§å†…å­˜ä½¿ç”¨
python -m memory_profiler main.py stage1

# ç›‘æ§CPUä½¿ç”¨
python -m cProfile -o profile.prof main.py stage1
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†ä»“åº“
git clone <repository-url>
cd wechat_message_processor

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# or
venv\Scripts\activate     # Windows

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements-dev.txt

# è¿è¡Œæµ‹è¯•
python -m pytest tests/
```

### ä»£ç è§„èŒƒ

- éµå¾ª PEP 8 ä»£ç é£æ ¼
- ä½¿ç”¨ç±»å‹æç¤º (Type Hints)
- ç¼–å†™è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²
- ä¿æŒå‡½æ•°å•ä¸€èŒè´£
- æ·»åŠ å•å…ƒæµ‹è¯•

### æäº¤è§„èŒƒ

```bash
# åŠŸèƒ½å¢åŠ 
git commit -m "feat: æ·»åŠ æ–°çš„å†å²è®°å½•ç­›é€‰åŠŸèƒ½"

# é—®é¢˜ä¿®å¤  
git commit -m "fix: ä¿®å¤è”ç³»äººæœç´¢ä¸­çš„ç¼–ç é—®é¢˜"

# æ–‡æ¡£æ›´æ–°
git commit -m "docs: æ›´æ–°READMEä¸­çš„é…ç½®è¯´æ˜"
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### å¤„ç†èƒ½åŠ›

| æ•°æ®è§„æ¨¡ | å•è¿›ç¨‹è€—æ—¶ | å¤šè¿›ç¨‹è€—æ—¶ | å†…å­˜ä½¿ç”¨ |
|----------|------------|------------|----------|
| 1ä¸‡æ¡æ¶ˆæ¯ | 2åˆ†é’Ÿ | 45ç§’ | 200MB |
| 10ä¸‡æ¡æ¶ˆæ¯ | 18åˆ†é’Ÿ | 5åˆ†é’Ÿ | 1.2GB |
| 100ä¸‡æ¡æ¶ˆæ¯ | 3å°æ—¶ | 45åˆ†é’Ÿ | 8GB |

### è¯„ä¼°æ€§èƒ½

| æ ·æœ¬æ•°é‡ | è¯„ä¼°è€—æ—¶ | APIè°ƒç”¨æ•° | ç¼“å­˜å‘½ä¸­ç‡ |
|----------|----------|-----------|------------|
| 1000æ ·æœ¬ | 5åˆ†é’Ÿ | 1000æ¬¡ | 0% |
| 5000æ ·æœ¬ | 12åˆ†é’Ÿ | 2000æ¬¡ | 60% |
| 10000æ ·æœ¬ | 20åˆ†é’Ÿ | 3000æ¬¡ | 70% |

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ è·å–æ”¯æŒ

- ğŸ“§ **é‚®ä»¶æ”¯æŒ**: support@example.com
- ğŸ’¬ **ç¤¾åŒºè®¨è®º**: [GitHub Discussions](https://github.com/your-repo/discussions)
- ğŸ› **é—®é¢˜æŠ¥å‘Š**: [GitHub Issues](https://github.com/your-repo/issues)
- ğŸ“– **è¯¦ç»†æ–‡æ¡£**: [Wikié¡µé¢](https://github.com/your-repo/wiki)

## ğŸ¯ å‘å±•è·¯çº¿å›¾

### v2.1 (è®¡åˆ’ä¸­)
- [ ] æ”¯æŒæ›´å¤šæ¶ˆæ¯ç±»å‹ï¼ˆè¯­éŸ³è½¬æ–‡å­—ã€å›¾ç‰‡æè¿°ï¼‰
- [ ] é›†æˆæ›´å¤šå¤§æ¨¡å‹è¯„ä¼°æœåŠ¡
- [ ] æ·»åŠ æ•°æ®å¯è§†åŒ–åŠŸèƒ½
- [ ] æ”¯æŒå¢é‡æ›´æ–°å¤„ç†

### v2.2 (è®¡åˆ’ä¸­)  
- [ ] Webç•Œé¢æ”¯æŒ
- [ ] æ•°æ®åº“å­˜å‚¨æ”¯æŒ
- [ ] åˆ†å¸ƒå¼å¤„ç†æ”¯æŒ
- [ ] è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

### v3.0 (è¿œæœŸè§„åˆ’)
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] ä¼ä¸šçº§éƒ¨ç½²æ–¹æ¡ˆ
- [ ] é«˜çº§æ•°æ®åˆ†æåŠŸèƒ½
- [ ] AIæ¨¡å‹è®­ç»ƒé›†æˆ

---

**ğŸŒŸ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼**

**ğŸ“¢ æ¬¢è¿åˆ†äº«æ‚¨çš„ä½¿ç”¨ç»éªŒå’Œæ”¹è¿›å»ºè®®ï¼**